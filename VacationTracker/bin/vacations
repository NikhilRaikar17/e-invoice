#!/bin/bash

database="database.db"
today="$(date +%Y-%m-%d)"

mailaddrs=($(sqlite3 "$database" "SELECT DISTINCT Mail FROM vacation WHERE EndDate > '$today';"))
for mailaddr in "${mailaddrs[@]}"; do
  sqlite3 "$database" "SELECT Mail,EndDate,StartDate FROM vacation WHERE Mail = '$mailaddr' AND EndDate > '$today' ORDER BY StartDate ASC;" | head -1 | 
tr '|' ';'
done
